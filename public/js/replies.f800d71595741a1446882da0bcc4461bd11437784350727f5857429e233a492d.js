(()=>{var d="https://mastodon.social/authorize_interaction?uri=";async function C(){let o=document.querySelector("#social-links > a");o.href=d+window.location.href;let e=await fetch(window.location.pathname+"replies");if(!e.ok){console.log(e.statusText);return}let n=await e.json();console.log(n),p(document.getElementById("replies"),n.items)}function p(o,e){if(e)for(item of e){let n=x(o,{name:item.actor.name,shortName:item.actor.preferredUsername,host:new URL(item.actor.id).hostname,picURL:item.actor.icon,userURL:item.actor.id,date:item.published,editDate:item.updated,opURL:item.url,content:item.content});p(n,item.replies.items)}}function x(o,e){let{name:n,shortName:i,host:f,picURL:u,userURL:h,date:y,editDate:a,opURL:r,content:R}=e,l={dateStyle:"long",timeStyle:"short"},s=new Intl.DateTimeFormat(void 0,l).format(new Date(y));if(a){let q=new Intl.DateTimeFormat(void 0,l).format(new Date(a));s+=" (Edited: "+q+")"}let t=document.getElementById("reply-template").content.cloneNode(!0),c=t.firstElementChild,[w,S]=t.querySelectorAll(".reply-profile-info a span");w.textContent="@"+i,S.textContent="@"+f;let E=c.getElementsByClassName("reply-contents")[0];E.innerHTML=R;let g=t.querySelector(".reply-top > img");g.src=u;let L=t.querySelector(".reply-profile-info > a");L.href=h;let[U,A]=t.querySelectorAll(".reply-profile-info > span");U.textContent=n||i,A.textContent=s;let D=t.querySelector(".reply-op-button > a");D.href=r;let[m,...N]=t.querySelectorAll(".reply-controls a");return new URL(r).host=="mastodon.social"?m.href=r:m.href=d+r,o.appendChild(t),c}async function B(){return C()}B();})();
